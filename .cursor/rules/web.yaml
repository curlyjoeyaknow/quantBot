---
description: Next.js web application rules for web/ directory
globs: ["web/**/*.ts", "web/**/*.tsx"]
alwaysApply: true
---

# Web Application Rules (web/)

nextjs-best-practices:
    - "Route handlers should be in `app/api/` directory"
    - "Use server components by default, client components when needed"
    - "Mark client components with `'use client'` directive"
    - "Use proper Next.js data fetching patterns"

api-routes:
    - "Use Next.js Route Handlers (not Pages API)"
    - "Implement proper error handling with try/catch"
    - "Return proper HTTP status codes"
    - "Use middleware for authentication and rate limiting"
    - "Validate request bodies with Zod schemas"
    - "Never expose sensitive data in responses"

components: 
    - "Use functional components with TypeScript"
    - "Define props with TypeScript interfaces"
    - "Use React hooks appropriately"
    - "Keep components focused and single-purpose"
    - "Extract reusable logic into custom hooks"
    - "Use proper memoization when needed"

client-side-code:
    - "Use React Query for data fetching"
    - "Implement proper loading and error states"
    - "Use optimistic updates where appropriate"
    - "Handle race conditions in async operations"
    - "Clean up subscriptions and timers in useEffect"

server-components:
    - "Use server components for data fetching"
    - "Pass serializable props only"
    - "Use async/await for data fetching"
    - "Handle errors with proper error boundaries"

styling:
    - "Use Tailwind CSS utility classes"
    - "Create reusable component variants"
    - "Use CSS modules for component-specific styles if needed"
    - "Follow responsive design principles"

type-safety:
    - "Define proper types for API responses"
    - "Use TypeScript strict mode"
    - "Validate API responses with Zod schemas"
    - "Use proper types for form data"

performance:
    - "Use Next.js Image component for images"
    - Implement proper code splitting
    - "Use dynamic imports for heavy components"
    - "Optimize bundle size"
    - "Use proper caching strategies"

security:
    - "Never expose API keys in client code"
    - "Validate all user inputs"
    - "Use proper authentication middleware"
    - "Implement CSRF protection"
    - "Sanitize user-generated content"

testing:
    - "Write unit tests for components"
    - "Use React Testing Library"
    - "Test user interactions, not implementation details"
    - "Mock external API calls"
    - "Test error states and edge cases"

